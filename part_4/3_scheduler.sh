# This file is automatically generated
pid=$(gcloud compute ssh --ssh-key-file ~/.ssh/cloud-computing ubuntu@memcache-server-k6kg --zone europe-west3-a --command "pgrep memcached")
echo "memcached pid is: $pid"
gcloud compute ssh --ssh-key-file ~/.ssh/cloud-computing ubuntu@memcache-server-k6kg --zone europe-west3-a --command "sudo taskset -a -cp 0-2 $pid"

gcloud compute ssh --ssh-key-file ~/.ssh/cloud-computing ubuntu@memcache-server-k6kg --zone europe-west3-a --command "sudo apt-get install python3-pip --yes"
gcloud compute ssh --ssh-key-file ~/.ssh/cloud-computing ubuntu@memcache-server-k6kg --zone europe-west3-a --command "sudo pip3 install docker"

gcloud compute scp ./preloader.py ubuntu@memcache-server-k6kg:. --ssh-key-file ~/.ssh/cloud-computing --zone europe-west3-a
gcloud compute ssh --ssh-key-file ~/.ssh/cloud-computing ubuntu@memcache-server-k6kg --zone europe-west3-a --command "python3 preloader.py"

gcloud compute scp ./scheduler.py ubuntu@memcache-server-k6kg:. --ssh-key-file ~/.ssh/cloud-computing --zone europe-west3-a
gcloud compute ssh --ssh-key-file ~/.ssh/cloud-computing ubuntu@memcache-server-k6kg --zone europe-west3-a --command "python3 scheduler.py"
